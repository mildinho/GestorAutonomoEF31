
@model IPagedList<Parceiro>
@{
    ViewData["Title"] = ViewBag.Crud.Titulo;
}


@*Tela com os Dados do CRUD ( Titulo, SubTitulo e Descricao )*@
@await Component.InvokeAsync("CRUD")


@*Tela de Pesquisa*@
@await Component.InvokeAsync("Pesquisar", new
    {
    placeholder = "Digite o Nome do Parceiro",
      aspaction = ""
})

<br />

@if (TempData["msg_s"] != null)
{
    <p class="alert alert-success">@TempData["msg_s"]</p>
}


@if (Model.Count > 0)
{
    <form method="post">

        <div class="table-responsive ">
            <table class="tablecenterCSS table table-bordered table-striped table-sm">
                <thead>
                    <tr style="text-align:center">
                        <th class="col-1">@Html.DisplayNameFor(model => model.First().Id)</th>
                        <th class="col-6">@Html.DisplayNameFor(model => model.First().Nome)</th>
                        <th class="col-2">@Html.DisplayNameFor(model => model.First().CNPJ_CPF)</th>
                        <th class="col-2">Tipo</th>
                      
                    </tr>
                </thead>
                <tbody>
                    @foreach (Parceiro parceiro in Model)
                    {
                        <tr>
                            <th scope="row" class="text-center">@parceiro.Id</th>

                            <td> @Html.DisplayFor(model => parceiro.Nome)</td>
                            <td>

                                @parceiro.CNPJ_CPF

                            </td>
                            <td>

                                <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="@String.Concat("C", parceiro.Id.ToString())" checked="@(parceiro.Cliente == 1)" onclick="triggerLink(@parceiro.Id,1)">
                                    <label class="custom-control-label font-weight-bold" for="@String.Concat("C", parceiro.Id.ToString())">Cliente</label>
                                </div>

                                <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="@String.Concat("F", parceiro.Id.ToString())" checked="@(parceiro.Fornecedor == 1)">
                                    <label class="custom-control-label font-weight-bold" for="@String.Concat("F", parceiro.Id.ToString())">Fornecedor</label>
                                </div>

                                <div class="custom-control custom-switch">
                                    <input type="checkbox" class="custom-control-input" id="@String.Concat("V", parceiro.Id.ToString())" checked="@(parceiro.Vendedor == 1)">
                                    <label class="custom-control-label font-weight-bold" for="@String.Concat("V", parceiro.Id.ToString())">Vendedor</label>
                                </div>
                            </td>

                          
                        </tr>
                    }
                </tbody>
            </table>

        </div>
        <br />
        @Html.PagedListPager((IPagedList)Model, pagina => Url.Action("Index", new { pagina }))
    </form>

}
else
{

    <div class="alert alert-info">
        <strong>Nenhum Registro Cadastrado!</strong>
    </div>

}


<script>
    function triggerLink(id, parceiro) {

        alert(id);
        $.ajax({
            type: "POST",
            headers: {
                "Accept": "application/json",
                "Content-Type": "application/text",
                "RequestVerificationToken": gettoken()
            },
            
            url: "/Admin/HabilitarParceiro/Manutencao/",
            data: { "Id": 1, "tipo": 1 },
            success: function (response) {
                alert("Tudo Lindo: " );

            },
            failure: function (response) {
                alert(response.responseText);
            },
            error: function (response) {
                alert(response.responseText);
                console.log(response.responseText);
            }
        });
    }


     function gettoken() {
        var token = '@Html.AntiForgeryToken()';
        token = $(token).val();
        return token;
   }
</script>
